<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>To Do List</title>
</head>
<body>
    {% if request.user.is_authenticated %}
        <nav style="text-align: right">
            {{ request.user.username }}
            <a href="{% url 'todo_create' %}">create_todo</a>
            <form action="{% url 'logout' %}" method="POST" style="display: inline">
                {% csrf_token %}
                <button>logout</button>
            </form>
        </nav>
        <h1>To Do</h1>
        {% for todo in page_obj %}
            <p>
                <a href="/todo/{{ todo.id }}/">{{ forloop.counter }}. {{ todo.title }}</a>
            </p>
        {% endfor %}
        <form method="get" style="margin-top: 30px; margin-bottom: 10px;">
            <input name="q" type="text" placeholder="검색어를 입력하세요." value="{% if request.GET.q %}{{ request.GET.q }}{% endif %}">
            <button>search</button>
        </form>
        <div>
            {% if page_obj.has_previous %}
                <a href="?page=1{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">&laquo; first</a>
                <a href="?page={{ page_obj.previous_page_number }}">previous</a>
            {% endif %}
            {% if page_obj.number|add:-2 > 1 %}
                <a href="?page={{ page_obj.number|add:-3 }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">&hellip;</a>
            {% endif %}
            {% for i in page_obj.paginator.page_range %}
                {% if page_obj.number == i %}
                    <span>({{ i }})</span>
                {% elif i > page_obj.number|add:-3 and i < page_obj.number|add:3 %}
                    <a href="?page={{ i }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">{{ i }}</a>
                {% endif %}
            {% endfor %}
            {% if page_obj.number|add:2 < page_obj.paginator.num_pages %}
                <a href="?page={{ page_obj.number|add:3 }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">&hellip;</a>
            {% endif %}
            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">next</a>
                <a href="?page={{ page_obj.paginator.num_pages }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">last &raquo;</a>
            {% endif %}
        </div>
    {% else %}
        <h1 style="text-align: center">Welcome~!</h1>
        <div style="text-align: center">
            <a href="{% url 'login' %}">login</a>
            <a>&nbsp</a>
            <a href="{% url 'sign_up' %}">sign up</a>
        </div>
    {% endif %}
</body>
</html>